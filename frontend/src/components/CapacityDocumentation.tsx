import React from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import {
    X, BookOpen, Target, Zap, Activity, Users,
    BarChart, TrendingUp, AlertTriangle, CheckCircle2,
    Info, ShieldCheck, PieChart, MousePointer2, Settings,
    ArrowRight, Sparkles, Layout, Globe, HelpCircle,
    Scale, Calendar, Rocket, RefreshCcw, Binary, Search,
    XCircle, Award, ListChecks, Layers
} from 'lucide-react';

interface CapacityDocumentationProps {
    isOpen: boolean;
    onClose: () => void;
}

const CapacityDocumentation: React.FC<CapacityDocumentationProps> = ({ isOpen, onClose }) => {
    return (
        <AnimatePresence>
            {isOpen && (
                <motion.div
                    initial={{ opacity: 0 }}
                    animate={{ opacity: 1 }}
                    exit={{ opacity: 0 }}
                    className="fixed inset-0 z-[100] flex items-center justify-center p-4 md:p-8 bg-slate-950/95 backdrop-blur-2xl"
                >
                    <motion.div
                        initial={{ scale: 0.95, y: 30, opacity: 0 }}
                        animate={{ scale: 1, y: 0, opacity: 1 }}
                        exit={{ scale: 0.95, y: 30, opacity: 0 }}
                        className="relative w-full max-w-7xl max-h-[92vh] bg-slate-900 border border-white/10 rounded-[48px] shadow-[0_0_100px_rgba(0,0,0,0.8)] overflow-hidden flex flex-col"
                    >
                        {/* Background Decorations */}
                        <div className="absolute top-0 right-0 w-[500px] h-[500px] bg-blue-600/10 blur-[120px] pointer-events-none" />
                        <div className="absolute bottom-0 left-0 w-[500px] h-[500px] bg-purple-600/10 blur-[120px] pointer-events-none" />

                        {/* Header */}
                        <div className="relative z-10 p-8 border-b border-white/5 flex items-center justify-between bg-white/5 sticky top-0 backdrop-blur-xl">
                            <div className="flex items-center gap-5">
                                <div className="w-14 h-14 rounded-2xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-2xl shadow-blue-500/30">
                                    <BookOpen className="text-white w-7 h-7" />
                                </div>
                                <div>
                                    <h2 className="text-3xl font-black text-white tracking-tighter uppercase italic">
                                        üìò Documenta√ß√£o Estrat√©gica
                                    </h2>
                                    <div className="flex items-center gap-3">
                                        <span className="text-[10px] font-black text-blue-400 uppercase tracking-[0.3em]">Gest√£o de Capacidade</span>
                                        <div className="w-1 h-1 rounded-full bg-white/20" />
                                        <span className="text-[10px] font-black text-purple-400 uppercase tracking-[0.3em]">Simula√ß√£o Comercial</span>
                                    </div>
                                </div>
                            </div>
                            <button
                                onClick={onClose}
                                className="p-4 rounded-2xl bg-white/5 hover:bg-white/10 text-slate-400 hover:text-white transition-all border border-white/5 shadow-inner group"
                            >
                                <X className="w-7 h-7 group-hover:rotate-90 transition-transform duration-300" />
                            </button>
                        </div>

                        {/* Content Body */}
                        <div className="relative z-10 flex-1 overflow-y-auto custom-scrollbar p-8 md:p-16 space-y-32">

                            {/* 1. VIS√ÉO GERAL */}
                            <section className="space-y-8">
                                <div className="flex items-center gap-4">
                                    <div className="px-4 py-1.5 rounded-full bg-blue-500/10 border border-blue-500/20 text-blue-400 text-[10px] font-black uppercase tracking-widest">
                                        Introdu√ß√£o
                                    </div>
                                </div>
                                <div className="grid grid-cols-1 lg:grid-cols-2 gap-16 items-start">
                                    <div className="space-y-6">
                                        <h3 className="text-5xl font-black text-white uppercase italic leading-[0.9] tracking-tighter">
                                            O Twin Digital da sua <br />
                                            <span className="text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-emerald-400">Opera√ß√£o Consultiva</span>
                                        </h3>
                                        <p className="text-slate-400 text-lg font-medium leading-relaxed italic border-l-4 border-blue-500/30 pl-8">
                                            A plataforma √© um sistema de Planejamento Estrat√©gico de Capacidade Operacional, desenhado para conectar o fechamento de um contrato com o ch√£o de f√°brica.
                                        </p>
                                    </div>
                                    <div className="grid grid-cols-1 gap-4">
                                        <div className="p-6 rounded-[32px] bg-white/5 border border-white/5 space-y-4">
                                            <h4 className="text-xs font-black text-white uppercase tracking-widest flex items-center gap-2">
                                                <Target className="w-4 h-4 text-blue-400" /> Objetivos de Neg√≥cio
                                            </h4>
                                            <div className="grid grid-cols-1 sm:grid-cols-2 gap-x-8 gap-y-3">
                                                {[
                                                    'Visualizar ocupa√ß√£o real',
                                                    'Prever datas realistas',
                                                    'Detectar riscos estruturais',
                                                    'Simular novos contratos',
                                                    'Decidir com previsibilidade'
                                                ].map((item, i) => (
                                                    <div key={i} className="flex items-center gap-3 text-[11px] font-black text-slate-300 uppercase tracking-tight">
                                                        <CheckCircle2 className="w-3 h-3 text-emerald-500" /> {item}
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            {/* üìê REGRAS DE NEG√ìCIO OFICIAIS (Total 11 rules) */}
                            <section className="space-y-16">
                                <div className="p-12 rounded-[56px] bg-slate-950 border border-white/5 relative overflow-hidden">
                                    <div className="absolute top-0 right-0 p-12 opacity-5 text-white">
                                        <Binary className="w-64 h-64" />
                                    </div>

                                    <div className="text-center space-y-4 mb-16 relative z-10">
                                        <h3 className="text-3xl font-black text-white uppercase italic tracking-widest">
                                            üìê Regras de Neg√≥cio Oficiais
                                        </h3>
                                        <p className="text-slate-500 text-xs font-bold uppercase tracking-[0.4em]">A Matem√°tica por tr√°s do Sucesso</p>
                                    </div>

                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 relative z-10">
                                        {[
                                            { n: '1', t: 'Capacidade Base', c: 'C√°lculo derivado de Cap. Di√°ria √ó Dias √öteis do per√≠odo. Limite m√°ximo imut√°vel.' },
                                            { n: '2', t: 'Tipos de Projeto', c: 'Planejados consomem apenas a margem livre. Cont√≠nuos s√£o prioridade estrutural.' },
                                            { n: '3', t: 'Aloca√ß√£o Proporcional', c: 'Compromisso Cont√≠nuo = Capacidade √∑ Membros. Valor din√¢mico e audit√°vel.' },
                                            { n: '4', t: 'Previs√£o Realista', c: 'Logic: Esfor√ßo Restante √∑ (Capacidade - Compromisso Cont√≠nuo).' },
                                            { n: '5', t: 'Satura√ß√£o Estrutural', c: 'Ocorre quando Projetos Cont√≠nuos ocupam 100% da carga di√°ria.' },
                                            { n: '6', t: 'Bloqueio de Projeto', c: 'Ativado automaticamente quando 100% do time alocado est√° saturado.' },
                                            { n: '7', t: 'Elasticidade', c: 'Buffer real de absor√ß√£o. Risco cr√≠tico quando abaixo de 15%.' },
                                            { n: '8', t: 'Trend Forecast', c: 'Proje√ß√£o futura de 90 dias baseada no encerramento gradual de backlogs.' },
                                            { n: '9', t: 'Simulador Comercial', c: 'Ambiente "What-If" que aplica as mesmas regras sem alterar dados reais.' },
                                            { n: '10', t: 'Reatividade Total', c: 'Rec√°lculo em tempo real (Realtime) a cada apontamento ou altera√ß√£o.' },
                                            { n: '11', t: 'Transpar√™ncia de Carga', c: 'N√£o h√° mascaramento ou reservas artificiais. O sistema exp√µe o risco.' }
                                        ].map((rule) => (
                                            <div key={rule.n} className="p-6 rounded-3xl bg-white/5 border border-white/5 hover:bg-white/10 transition-all space-y-3 group">
                                                <div className="flex items-center gap-3">
                                                    <span className="text-[10px] font-black text-blue-500 bg-blue-500/10 px-2 py-0.5 rounded-md">{rule.n}</span>
                                                    <h5 className="text-[11px] font-black text-white uppercase tracking-widest group-hover:text-blue-400 transition-colors">{rule.t}</h5>
                                                </div>
                                                <p className="text-[10px] text-slate-400 leading-relaxed italic">{rule.c}</p>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </section>

                            {/* 3. MOTOR & CONCEITOS (Merging the two lists) */}
                            <section className="grid grid-cols-1 lg:grid-cols-2 gap-16 items-center">
                                <div className="space-y-12">
                                    <div className="space-y-6">
                                        <div className="flex items-center gap-3">
                                            <Settings className="w-5 h-5 text-orange-400" />
                                            <h4 className="text-xl font-black text-white uppercase italic tracking-wider italic">O Motor de C√°lculo</h4>
                                        </div>

                                        <div className="space-y-6">
                                            <div className="p-8 rounded-[40px] bg-white/5 border border-white/5 space-y-4">
                                                <h5 className="text-xs font-black text-blue-400 uppercase tracking-widest underline underline-offset-4 decoration-blue-500/30">Previs√£o Dual</h5>
                                                <div className="grid grid-cols-2 gap-8">
                                                    <div className="space-y-2">
                                                        <p className="text-[11px] font-black text-white uppercase">1. Previs√£o Ideal</p>
                                                        <p className="text-[10px] text-slate-400 italic">"Qual a menor data tecnicamente poss√≠vel?" (100% de foco)</p>
                                                    </div>
                                                    <div className="space-y-2">
                                                        <p className="text-[11px] font-black text-emerald-400 uppercase">2. Previs√£o Realista</p>
                                                        <p className="text-[10px] text-slate-400 italic">"Quando ser√° entregue de fato?" (Considera opera√ß√£o cont√≠nua)</p>
                                                    </div>
                                                </div>
                                            </div>

                                            <div className="p-8 rounded-[40px] bg-white/5 border border-white/5 space-y-4">
                                                <h5 className="text-xs font-black text-amber-400 uppercase tracking-widest underline underline-offset-4 decoration-amber-500/30">Compromisso Estrutural</h5>
                                                <p className="text-[11px] text-slate-400 leading-relaxed italic">
                                                    O sistema n√£o aceita percentuais fixos. Se um projeto cont√≠nuo tem 4 pessoas, cada uma "perde" 25% de sua capacidade (ex: 2h de 8h).
                                                </p>
                                                <div className="flex gap-4">
                                                    <div className="text-[9px] font-black text-slate-500 uppercase flex items-center gap-2"> <ArrowRight className="w-3 h-3" /> Aloca Dinamicamente </div>
                                                    <div className="text-[9px] font-black text-slate-500 uppercase flex items-center gap-2"> <ArrowRight className="w-3 h-3" /> Automatiza Gest√£o </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div className="space-y-8">
                                    <div className="p-10 rounded-[48px] bg-gradient-to-br from-red-600 to-orange-700 text-white shadow-2xl relative overflow-hidden">
                                        <div className="absolute top-0 right-0 p-8 opacity-20">
                                            <AlertTriangle className="w-48 h-48" />
                                        </div>
                                        <div className="relative z-10 space-y-6">
                                            <h4 className="text-sm font-black uppercase tracking-[0.3em]">Gest√£o de Riscos</h4>
                                            <h3 className="text-4xl font-black italic uppercase leading-none">Satura√ß√£o & <br />Gargalos</h3>
                                            <div className="space-y-4 text-xs font-bold leading-relaxed opacity-90 italic border-l border-white/30 pl-6">
                                                <p>Satura√ß√£o: Quando compromisso cont√≠nuo ‚â• capacidade total.</p>
                                                <p>Bloqueio: Quando 100% do time alocado no projeto est√° saturado.</p>
                                                <p className="pt-2 text-[10px] uppercase font-black tracking-widest">O sistema n√£o mascara o problema. Ele exp√µe a falha estrutural.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            {/* 7. SIMULADOR & MAPA (Merging Section 7 & 8) */}
                            <section className="space-y-12">
                                <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                                    {/* Simulador Card */}
                                    <div className="p-12 rounded-[56px] bg-gradient-to-br from-blue-700 to-indigo-800 text-white relative overflow-hidden group/sim shadow-2xl shadow-blue-500/20">
                                        <div className="absolute top-0 right-0 p-12 opacity-10 group-hover/sim:rotate-12 transition-transform duration-500">
                                            <Zap className="w-64 h-64" />
                                        </div>
                                        <div className="relative z-10 space-y-8">
                                            <span className="inline-block px-3 py-1 rounded-full bg-white/20 text-[9px] font-black uppercase tracking-widest text-blue-200">What-If Analysis</span>
                                            <h3 className="text-4xl font-black italic uppercase leading-none">Simulador Comercial</h3>
                                            <p className="text-sm font-medium opacity-80 leading-relaxed italic border-l-2 border-white/20 pl-6">
                                                Permite simular o acr√©scimo de centenas de horas e ver quem ser√° afetado, quantos dias o backlog ser√° deslocado e quem entrar√° em satura√ß√£o cr√≠tica.
                                            </p>
                                        </div>
                                    </div>

                                    {/* Mapa & Reatividade Card */}
                                    <div className="p-12 rounded-[56px] bg-slate-900 border border-white/10 relative overflow-hidden shadow-xl">
                                        <div className="absolute top-0 right-0 p-12 opacity-5">
                                            <Layers className="w-48 h-48" />
                                        </div>
                                        <div className="relative z-10 space-y-8">
                                            <div className="flex items-center gap-3">
                                                <Activity className="w-5 h-5 text-emerald-400" />
                                                <h4 className="text-lg font-black text-white uppercase tracking-widest italic">Mapa & Reatividade</h4>
                                            </div>
                                            <div className="space-y-4">
                                                <div className="flex items-start gap-4">
                                                    <div className="w-8 h-8 rounded-xl bg-emerald-500/10 flex items-center justify-center flex-shrink-0"> <RefreshCcw className="w-4 h-4 text-emerald-400" /> </div>
                                                    <div className="space-y-1">
                                                        <p className="text-[11px] font-black text-white uppercase">Reatividade Autom√°tica</p>
                                                        <p className="text-[10px] text-slate-500 leading-relaxed italic">C√°lculos atualizados em tempo real a cada apontamento de horas ou conclus√£o de tarefa.</p>
                                                    </div>
                                                </div>
                                                <div className="flex items-start gap-4">
                                                    <div className="w-8 h-8 rounded-xl bg-blue-500/10 flex items-center justify-center flex-shrink-0"> <PieChart className="w-4 h-4 text-blue-400" /> </div>
                                                    <div className="space-y-1">
                                                        <p className="text-[11px] font-black text-white uppercase">Visualiza√ß√£o de Saldo</p>
                                                        <p className="text-[10px] text-slate-500 leading-relaxed italic">Controle total sobre Horas Planejadas vs Horas Cont√≠nuas vs Saldo Dispon√≠vel.</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            {/* 10, 11, 12: ESTRAT√âGIA & DEFINI√á√ÉO */}
                            <section className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                                <div className="p-8 rounded-[40px] bg-white/5 border border-white/5 space-y-6">
                                    <h5 className="text-xs font-black text-blue-400 uppercase tracking-widest flex items-center gap-2 italic">
                                        <Scale className="w-4 h-4" /> Perguntas Chave
                                    </h5>
                                    <div className="space-y-3">
                                        {[
                                            'Quando podemos iniciar o pr√≥ximo projeto?',
                                            'Temos bra√ßo para demanda urgente?',
                                            'Qual o custo de aceitar esse contrato?',
                                            'A satura√ß√£o √© tempor√°ria ou estrutural?'
                                        ].map((q, i) => (
                                            <div key={i} className="p-3 rounded-2xl bg-white/5 border border-white/5 text-[10px] font-bold text-slate-300 italic group hover:bg-white/10 transition-all">
                                                "{q}"
                                            </div>
                                        ))}
                                    </div>
                                </div>

                                <div className="p-8 rounded-[40px] bg-emerald-500/5 border border-emerald-500/20 space-y-6">
                                    <h5 className="text-xs font-black text-emerald-400 uppercase tracking-widest flex items-center gap-2 italic">
                                        <Award className="w-4 h-4" /> Benef√≠cios Diretos
                                    </h5>
                                    <div className="space-y-3">
                                        {[
                                            'Redu√ß√£o de atrasos inesperados',
                                            'Previsibilidade de entrega audit√°vel',
                                            'Decis√£o comercial com base em dados',
                                            'Equil√≠brio entre opera√ß√£o e crescimento'
                                        ].map((b, i) => (
                                            <div key={i} className="flex items-center gap-3 text-[10px] font-black text-slate-200 uppercase tracking-tight">
                                                <ListChecks className="w-4 h-4 text-emerald-500" /> {b}
                                            </div>
                                        ))}
                                    </div>
                                </div>

                                <div className="p-8 rounded-[40px] bg-slate-950/50 border border-white/5 flex flex-col justify-between">
                                    <div className="space-y-6">
                                        <h5 className="text-xs font-black text-[var(--muted)] uppercase tracking-widest flex items-center gap-2 italic italic">
                                            <Binary className="w-4 h-4" /> O que √© o Twin Digital?
                                        </h5>
                                        <div className="space-y-4">
                                            <div className="flex gap-3 items-start">
                                                <Search className="w-4 h-4 text-blue-400 flex-shrink-0" />
                                                <p className="text-[10px] font-bold text-slate-400">N√ÉO √â apenas um gestor de tarefas ou controle de horas.</p>
                                            </div>
                                            <div className="flex gap-3 items-start">
                                                <Rocket className="w-4 h-4 text-purple-400 flex-shrink-0" />
                                                <p className="text-[10px] font-bold text-slate-300 italic uppercase tracking-tight">√â UM radar de risco operacional e um simulador estrat√©gico de vendas.</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div className="flex justify-center pt-8 opacity-20 grayscale hover:grayscale-0 transition-all">
                                        <ShieldCheck className="w-12 h-12 text-blue-500" />
                                    </div>
                                </div>
                            </section>

                            {/* Footer */}
                            <footer className="pt-16 border-t border-white/5 flex flex-col items-center gap-10 text-center">
                                <div className="flex flex-wrap justify-center gap-3">
                                    {['Resili√™ncia', 'Previsibilidade', 'Transpar√™ncia', 'Agilidade', 'Rentabilidade'].map((tag) => (
                                        <span key={tag} className="text-[9px] font-black text-slate-500 uppercase tracking-widest border border-white/10 px-4 py-2 rounded-xl">
                                            #{tag}
                                        </span>
                                    ))}
                                </div>
                                <div className="space-y-2">
                                    <p className="text-[10px] font-black text-slate-600 uppercase tracking-widest italic">
                                        Documento Unificado de Diretrizes Estrat√©gicas e Regras de Neg√≥cio
                                    </p>
                                    <p className="text-[8px] font-black text-slate-700 uppercase tracking-widest">
                                        SISTEMA DE GEST√ÉO ESTRAT√âGICA ¬© 2026 ‚Ä¢ TODOS OS DIREITOS RESERVADOS
                                    </p>
                                </div>
                            </footer>

                        </div>
                    </motion.div>
                </motion.div>
            )}
        </AnimatePresence>
    );
};

export default CapacityDocumentation;
